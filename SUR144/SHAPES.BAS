3 KEY OFF
4 SCREEN 1:CLS
5 DIM LI$(9),CURSOR%(134)
8 LA$=CHR$(0)+CHR$(75):RA$=CHR$(0)+CHR$(77):UA$=CHR$(0)+CHR$(72):DA$=CHR$(0)+CHR$(80):EK$="q"
10 OPEN "r",#2,"b:shapes.shp",128
20 FIELD #2,10 AS L$(0),10 AS L$(1),10 AS L$(2),10 AS L$(3),10 AS L$(4),10 AS L$(5),10 AS L$(6),10 AS L$(7),10 AS L$(8),10 AS L$(9):CLOSE #2
25 DRAW"bm100,100c1d5r5u5l5":GET (100,100)-(105,105),CURSOR%:CLS
30 GOSUB 9000:GOSUB 4000
35 X=0:Y=0
40 GOSUB 2200:IF A$="" THEN PUT(X*10+12,Y*10+12),CURSOR%,XOR:PUT(X*10+12,Y*10+12),CURSOR%,XOR:GOTO 40
50 DX=0:DY=0:IF A$=UA$ THEN DY=-1 ELSE IF A$=DA$ THEN DY=1 ELSE IF A$=LA$ THEN DX=-1 ELSE IF A$=RA$ THEN DX=1
55 IF X+DX<0 OR X+DX>9 THEN DX=0
56 IF Y+DY<0 OR Y+DY>9 THEN DY=0
60 X=X+DX:Y=Y+DY
70 IF A$=" " THEN GOSUB 3000
75 IF A$="c" THEN GOSUB 4000
76 IF A$="g" THEN GOSUB 5000 ELSE IF A$="p" THEN GOSUB 6000
100 GOTO 40
900 SCREEN 2:SCREEN 0,0,0
999 END
1000 LINE(0,0)-(110,110),0,BF:FOR I=10 TO 100 STEP 10:FOR J=10 TO 100 STEP 10
1010 IF MID$(LI$(INT(J/10)-1),INT(I/10),1)="1" THEN LINE(I,J)-(I+9,J+9),1,BF:PSET(I/10-1+120,J/10-1+120) ELSE LINE(I,J)-(I+9,J+9),1,B:PRESET(I/10-1+120,J/10-1+120)
1020 NEXT J,I
1030 RETURN
2000 SCREEN 2:SCREEN 0,0,0:END
2197 '
2198 ' inkey replacement
2199 '
2200 A$=INKEY$
2210 IF LEN(A$)=2 THEN LB=ASC(LEFT$(A$,1)):RB=ASC(RIGHT$(A$,1))
2230 IF A$=EK$ THEN GOSUB 900:END
2280 RETURN
3000 B$=MID$(LI$(Y),X+1,1)
3010 IF B$="1" THEN B$="0" ELSE B$="1"
3020 MID$(LI$(Y),X+1)=B$
3030 IF B$="1" THEN LINE(X*10+11,Y*10+11)-(X*10+18,Y*10+18),1,BF:PSET(X+120,Y+120) ELSE LINE(X*10+11,Y*10+11)-(X*10+18,Y*10+18),0,BF:PRESET(X+120,Y+120)
3040 RETURN
4000 FOR I=0 TO 9:LI$(I)="0000000000":NEXT
4010 GOSUB 1000
4020 RETURN
5000 LOCATE 17,1:INPUT"get shape ",S:IF S>20 OR S<1 THEN 5030
5005 OPEN "r",#2,"b:shapes.shp",128
5010 GET #2,S
5015 CLOSE #2
5017 GOSUB 8000
5020 GOSUB 1000
5030 RETURN
6000 LOCATE 17,1:INPUT"put shape ",S:IF S>20 OR S<1 THEN 6030
6004 OPEN "r",#2,"b:shapes.shp",128
6005 GOSUB 7000
6010 PUT #2,S
6015 CLOSE #2
6025 Z=S:GOSUB 10000
6030 RETURN
7000 FOR M=0 TO 9
7010 RSET L$(M)=LI$(M)
7020 NEXT M
7030 RETURN
8000 FOR M=0 TO 9
8010 LI$(M)=L$(M)
8020 NEXT M
8030 RETURN
9000 LOCATE 20,1:PRINT"1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0";
9002 FOR Z=1 TO 20
9005 OPEN "r",#2,"b:shapes.shp",128
9010 GET #2,Z
9020 CLOSE #2
9030 GOSUB 8000:GOSUB 10000
9040 NEXT Z
9050 RETURN
10000 FOR I=0 TO 9:FOR J=0 TO 9
10010 IF MID$(LI$(J),I+1,1)="1" THEN PSET((Z-1)*16+I,J+140) ELSE PRESET((Z-1)*16+I,J+140)
10020 NEXT J,I
10030 RETURN

